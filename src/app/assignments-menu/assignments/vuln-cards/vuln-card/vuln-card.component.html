<div class="vuln-card">
  <div class="vuln-card__left">
    <!-- Severity square -->
    <div class="severity-square" [ngStyle]="{ background: severityColor }">
      <span class="severity-letter">{{ severityAbbr }}</span>
    </div>
    <!-- Source icon -->
    <div class="source-icon-bg" [ngStyle]="{ background: severityColor }">
      <img class="source-icon" [src]="sourceIcon" alt="source" />
    </div>
  </div>
  <div class="vuln-card__main">
    <div class="main-top-row">
      <button class="copy-btn" title="Copy ID">
        <img src="assets/icons/copy-icon.svg" alt="copy" />
      </button>
      <span class="vuln-id">{{ card.id }}</span>
      <img
        *ngIf="card.disputed"
        class="disputed-icon"
        src="assets/icons/disputed-icon-new.svg"
        alt="disputed"
      />
      <span *ngIf="card.cvss" class="cvss-pill">
        {{ card.cvss }}
        <span style="display: inline-flex; align-items: center">
          CVSS
          <span
            style="display: inline-flex; border-radius: 4px; margin-left: 2px"
          >
            <img
              src="assets/icons/alternative_ids_plus-new.svg"
              alt="redirect"
              style="height: 16px; width: 16px; background: transparent"
            />
          </span>
        </span>
      </span>
      <span *ngIf="card.epss" class="epss-pill">
        {{ card.epss * 100 | number : "1.0-0" }}% EPSS
      </span>
      <button class="redirect-btn" title="Go to details">
        <img src="assets/icons/export-icon-new.svg" alt="redirect" />
      </button>
    </div>
    <div class="main-bottom-row">
      <div style="display: flex; align-items: center; gap: 16px">
        <span class="date-info">
          <img src="assets/icons/calendar-new.svg" alt="calendar" />
          <span style="font-weight: bold">Published:</span>
          {{ card.publishedAt * 1000 | date : "MMM d, yyyy" }}
        </span>
        <span class="component-info">
          <img src="assets/icons/content-copy-icon-new.svg" alt="component" />
          {{ card.components?.[0]?.name



          }}<span *ngIf="card.components?.[0]?.versions"
            >, versions: {{ card.components[0].versions }}</span
          >
        </span>
      </div>
      <div
        style="margin-top: 4px; display: flex; align-items: center; gap: 16px"
      >
        <span
          class="date-info"
          style="display: inline-flex; align-items: center"
        >
          <img src="assets/icons/calendar-new.svg" alt="calendar" />
          <span style="font-weight: bold">Updated:</span>
          {{ card.modifiedAt * 1000 | date : "MMM d, yyyy" }}
        </span>
        <span class="desc-info">
          <img src="assets/icons/desc-icon-new.svg" alt="desc" />
          {{ card.summary }}
        </span>
      </div>
    </div>
  </div>
  <div class="vuln-card__right">
    <div class="vdp-vex-row">
      <span class="vdp-pill">VDP</span>
      <span class="vex-pill">VEX</span>
    </div>
    <div class="imported-indicator">
      <img src="assets/icons/imported-icon-new.svg" alt="imported" />
    </div>
  </div>
</div>
